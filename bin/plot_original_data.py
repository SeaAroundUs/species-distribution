#!/usr/bin/env python

""" visualizes the S000000.csv distributions generated by the original SpecDis tool """

import glob
import logging
import os
import sys

import numpy as np
from PIL import Image

OUTPUT_DIR = len(sys.argv) == 2 and sys.argv[1] or "/tmp/specdis"

logging.basicConfig(level=logging.INFO)

for fname in glob.glob('S*.csv'):

    logging.info(fname)

    with open(fname) as f:
        grid = np.fromiter(f, dtype=int, count=360*720).reshape((360, 720))

    # normalize for PIL
    grid = (grid / grid.max() * 255).astype(np.uint8)

    image = Image.fromarray(grid)
    output = os.path.join(OUTPUT_DIR, fname + '.png')
    image.save(output)
